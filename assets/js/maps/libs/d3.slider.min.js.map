{"version":3,"sources":["libs/d3.slider.js"],"names":["root","factory","define","amd","exports","process","browser","require","module","d3","slider","this","value","scale","axisScale","handle1","divRange","sliderLength","min","max","step","animate","orientation","axis","margin","active","snap","dispatch","formatPercent","format","tickFormat","handle2","selection","each","linear","domain","div","select","classed","drag","behavior","on","slideend","event","toType","length","append","attr","stopPropagation","call","pos","Math","offsetX","layerX","moveHandle","invert","stepValue","nearestTick","style","onDragHorizontal","width","parseFloat","parseInt","offsetY","layerY","onDragVertical","top","sourceEvent","target","id","x","y","dom","svg","ticks","round","orient","copy","range","rangePoints","g","height","createAxis","newValue","currentValue","oldPos","newPos","position","slide","transition","styleTween","interpolate","duration","val","alignValue","valModStep","abs","dist","map","d","i","index","r","rangeExtent","v","toString","match","toLowerCase","_","arguments","rebind"],"mappings":"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","file":"../../libs/d3.slider.min.js","sourcesContent":["/*\n    D3.js Slider\n    Inspired by jQuery UI Slider\n    Copyright (c) 2013, Bjorn Sandvik - http://blog.thematicmapping.org\n    BSD license: http://opensource.org/licenses/BSD-3-Clause\n*/\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['d3'], factory);\n  } else if (typeof exports === 'object') {\n    if (process.browser) {\n      // Browserify. Import css too using cssify.\n      require('./d3.slider.css');\n    }\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require('d3'));\n  } else {\n    // Browser globals (root is window)\n    root.d3.slider = factory(root.d3);\n  }\n}(this, function (d3) {\nreturn function module() {\n  \"use strict\";\n\n  // Public variables width default settings\n  var min = 0,\n      max = 100,\n      step = 0.01,\n      animate = true,\n      orientation = \"horizontal\",\n      axis = false,\n      margin = 50,\n      value,\n      active = 1,\n      snap = false,\n      scale;\n\n  // Private variables\n  var axisScale,\n      dispatch = d3.dispatch(\"slide\", \"slideend\"),\n      formatPercent = d3.format(\".2%\"),\n      tickFormat = d3.format(\".0\"),\n      handle1,\n      handle2 = null,\n      divRange,\n      sliderLength;\n\n  function slider(selection) {\n    selection.each(function() {\n\n      // Create scale if not defined by user\n      if (!scale) {\n        scale = d3.scale.linear().domain([min, max]);\n      }\n\n      // Start value\n      value = value || scale.domain()[0];\n\n      // DIV container\n      var div = d3.select(this).classed(\"d3-slider d3-slider-\" + orientation, true);\n      \n      var drag = d3.behavior.drag();\n      drag.on('dragend', function () {\n        dispatch.slideend(d3.event, value);\n      })\n\n      // Slider handle\n      //if range slider, create two\n      // var divRange;\n\n      if (toType(value) == \"array\" && value.length == 2) {\n        handle1 = div.append(\"a\")\n          .classed(\"d3-slider-handle\", true)\n          .attr(\"xlink:href\", \"#\")\n          .attr('id', \"handle-one\")\n          .on(\"click\", stopPropagation)\n          .call(drag);\n        handle2 = div.append(\"a\")\n          .classed(\"d3-slider-handle\", true)\n          .attr('id', \"handle-two\")\n          .attr(\"xlink:href\", \"#\")\n          .on(\"click\", stopPropagation)\n          .call(drag);\n      } else {\n        handle1 = div.append(\"a\")\n          .classed(\"d3-slider-handle\", true)\n          .attr(\"xlink:href\", \"#\")\n          .attr('id', \"handle-one\")\n          .on(\"click\", stopPropagation)\n          .call(drag);\n      }\n      \n      // Horizontal slider\n      if (orientation === \"horizontal\") {\n\n        div.on(\"click\", onClickHorizontal);\n        \n        if (toType(value) == \"array\" && value.length == 2) {\n          divRange = d3.select(this).append('div').classed(\"d3-slider-range\", true);\n\n          handle1.style(\"left\", formatPercent(scale(value[ 0 ])));\n          divRange.style(\"left\", formatPercent(scale(value[ 0 ])));\n          drag.on(\"drag\", onDragHorizontal);\n\n          var width = 100 - parseFloat(formatPercent(scale(value[ 1 ])));\n          handle2.style(\"left\", formatPercent(scale(value[ 1 ])));\n          divRange.style(\"right\", width+\"%\");\n          drag.on(\"drag\", onDragHorizontal);\n\n        } else {\n          handle1.style(\"left\", formatPercent(scale(value)));\n          drag.on(\"drag\", onDragHorizontal);\n        }\n        \n        sliderLength = parseInt(div.style(\"width\"), 10);\n\n      } else { // Vertical\n\n        div.on(\"click\", onClickVertical);\n        drag.on(\"drag\", onDragVertical);\n        if (toType(value) == \"array\" && value.length == 2) {\n          divRange = d3.select(this).append('div').classed(\"d3-slider-range-vertical\", true);\n\n          handle1.style(\"bottom\", formatPercent(scale(value[ 0 ])));\n          divRange.style(\"bottom\", formatPercent(scale(value[ 0 ])));\n          drag.on(\"drag\", onDragVertical);\n\n          var top = 100 - parseFloat(formatPercent(scale(value[ 1 ])));\n          handle2.style(\"bottom\", formatPercent(scale(value[ 1 ])));\n          divRange.style(\"top\", top+\"%\");\n          drag.on(\"drag\", onDragVertical);\n\n        } else {\n          handle1.style(\"bottom\", formatPercent(scale(value)));\n          drag.on(\"drag\", onDragVertical);\n        }\n        \n        sliderLength = parseInt(div.style(\"height\"), 10);\n\n      }\n      \n      if (axis) {\n        createAxis(div);\n      }\n\n\n      function createAxis(dom) {\n\n        // Create axis if not defined by user\n        if (typeof axis === \"boolean\") {\n\n          axis = d3.svg.axis()\n              .ticks(Math.round(sliderLength / 100))\n              .tickFormat(tickFormat)\n              .orient((orientation === \"horizontal\") ? \"bottom\" :  \"right\");\n\n        }\n\n        // Copy slider scale to move from percentages to pixels\n        axisScale = scale.ticks ? scale.copy().range([0, sliderLength]) : scale.copy().rangePoints([0, sliderLength], 0.5);\n          axis.scale(axisScale);\n\n          // Create SVG axis container\n        var svg = dom.append(\"svg\")\n            .classed(\"d3-slider-axis d3-slider-axis-\" + axis.orient(), true)\n            .on(\"click\", stopPropagation);\n\n        var g = svg.append(\"g\");\n\n        // Horizontal axis\n        if (orientation === \"horizontal\") {\n\n          svg.style(\"margin-left\", -margin + \"px\");\n\n          svg.attr({\n            width: sliderLength + margin * 2,\n            height: margin\n          });\n\n          if (axis.orient() === \"top\") {\n            svg.style(\"top\", -margin + \"px\");\n            g.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\");\n          } else { // bottom\n            g.attr(\"transform\", \"translate(\" + margin + \",0)\");\n          }\n\n        } else { // Vertical\n\n          svg.style(\"top\", -margin + \"px\");\n\n          svg.attr({\n            width: margin,\n            height: sliderLength + margin * 2\n          });\n\n          if (axis.orient() === \"left\") {\n            svg.style(\"left\", -margin + \"px\");\n            g.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\");\n          } else { // right          \n            g.attr(\"transform\", \"translate(\" + 0 + \",\" + margin + \")\");\n          }\n\n        }\n\n        g.call(axis);\n\n      }\n\n      function onClickHorizontal() {\n        if (toType(value) != \"array\") {\n          var pos = Math.max(0, Math.min(sliderLength, d3.event.offsetX || d3.event.layerX));\n          moveHandle(scale.invert ? \n                      stepValue(scale.invert(pos / sliderLength))\n                    : nearestTick(pos / sliderLength));\n        }\n      }\n\n      function onClickVertical() {\n        if (toType(value) != \"array\") {\n          var pos = sliderLength - Math.max(0, Math.min(sliderLength, d3.event.offsetY || d3.event.layerY));\n          moveHandle(scale.invert ? \n                      stepValue(scale.invert(pos / sliderLength))\n                    : nearestTick(pos / sliderLength));\n        }\n      }\n\n      function onDragHorizontal() {\n        if ( d3.event.sourceEvent.target.id === \"handle-one\") {\n          active = 1;\n        } else if ( d3.event.sourceEvent.target.id == \"handle-two\" ) {\n          active = 2;\n        }\n        var pos = Math.max(0, Math.min(sliderLength, d3.event.x));\n        moveHandle(scale.invert ? \n                    stepValue(scale.invert(pos / sliderLength))\n                  : nearestTick(pos / sliderLength));\n      }\n\n      function onDragVertical() {\n        if ( d3.event.sourceEvent.target.id === \"handle-one\") {\n          active = 1;\n        } else if ( d3.event.sourceEvent.target.id == \"handle-two\" ) {\n          active = 2;\n        }\n        var pos = sliderLength - Math.max(0, Math.min(sliderLength, d3.event.y))\n        moveHandle(scale.invert ? \n                    stepValue(scale.invert(pos / sliderLength))\n                  : nearestTick(pos / sliderLength));\n      }\n\n      function stopPropagation() {\n        d3.event.stopPropagation();\n      }\n\n    });\n\n  }\n\n  // Move slider handle on click/drag\n  function moveHandle(newValue) {\n    var currentValue = toType(value) == \"array\"  && value.length == 2 ? value[active - 1]: value,\n        oldPos = formatPercent(scale(stepValue(currentValue))),\n        newPos = formatPercent(scale(stepValue(newValue))),\n        position = (orientation === \"horizontal\") ? \"left\" : \"bottom\";\n    if (oldPos !== newPos) {\n\n      if (toType(value) == \"array\" && value.length == 2) {\n        value[ active - 1 ] = newValue;\n        if (d3.event) {\n          dispatch.slide(d3.event, value );\n        };\n      } else {\n        if (d3.event) {\n          dispatch.slide(d3.event.sourceEvent || d3.event, value = newValue);\n        };\n      }\n\n      if ( value[ 0 ] >= value[ 1 ] ) return;\n      if ( active === 1 ) {\n        if (toType(value) == \"array\" && value.length == 2) {\n          (position === \"left\") ? divRange.style(\"left\", newPos) : divRange.style(\"bottom\", newPos);\n        }\n\n        if (animate) {\n          handle1.transition()\n              .styleTween(position, function() { return d3.interpolate(oldPos, newPos); })\n              .duration((typeof animate === \"number\") ? animate : 250);\n        } else {\n          handle1.style(position, newPos);\n        }\n      } else {\n        \n        var width = 100 - parseFloat(newPos);\n        var top = 100 - parseFloat(newPos);\n\n        (position === \"left\") ? divRange.style(\"right\", width + \"%\") : divRange.style(\"top\", top + \"%\");\n        \n        if (animate) {\n          handle2.transition()\n              .styleTween(position, function() { return d3.interpolate(oldPos, newPos); })\n              .duration((typeof animate === \"number\") ? animate : 250);\n        } else {\n          handle2.style(position, newPos);\n        }\n      }\n    }\n  }\n\n  // Calculate nearest step value\n  function stepValue(val) {\n\n    if (val === scale.domain()[0] || val === scale.domain()[1]) {\n      return val;\n    }\n\n    var alignValue = val;\n    if (snap) {\n      alignValue = nearestTick(scale(val));\n    } else{\n      var valModStep = (val - scale.domain()[0]) % step;\n      alignValue = val - valModStep;\n\n      if (Math.abs(valModStep) * 2 >= step) {\n        alignValue += (valModStep > 0) ? step : -step;\n      }\n    };\n\n    return alignValue;\n\n  }\n\n  // Find the nearest tick\n  function nearestTick(pos) {\n    var ticks = scale.ticks ? scale.ticks() : scale.domain();\n    var dist = ticks.map(function(d) {return pos - scale(d);});\n    var i = -1,\n        index = 0,\n        r = scale.ticks ? scale.range()[1] : scale.rangeExtent()[1];\n    do {\n        i++;\n        if (Math.abs(dist[i]) < r) {\n          r = Math.abs(dist[i]);\n          index = i;\n        };\n    } while (dist[i] > 0 && i < dist.length - 1);\n\n    return ticks[index];\n  };\n\n  // Return the type of an object\n  function toType(v) {\n    return ({}).toString.call(v).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n  };\n\n  // Getter/setter functions\n  slider.min = function(_) {\n    if (!arguments.length) return min;\n    min = _;\n    return slider;\n  };\n\n  slider.max = function(_) {\n    if (!arguments.length) return max;\n    max = _;\n    return slider;\n  };\n\n  slider.step = function(_) {\n    if (!arguments.length) return step;\n    step = _;\n    return slider;\n  };\n\n  slider.animate = function(_) {\n    if (!arguments.length) return animate;\n    animate = _;\n    return slider;\n  };\n\n  slider.orientation = function(_) {\n    if (!arguments.length) return orientation;\n    orientation = _;\n    return slider;\n  };\n\n  slider.axis = function(_) {\n    if (!arguments.length) return axis;\n    axis = _;\n    return slider;\n  };\n\n  slider.margin = function(_) {\n    if (!arguments.length) return margin;\n    margin = _;\n    return slider;\n  };\n\n  slider.value = function(_) {\n    if (!arguments.length) return value;\n    if (value) {\n      moveHandle(stepValue(_));\n    };\n    value = _;\n    return slider;\n  };\n\n  slider.snap = function(_) {\n    if (!arguments.length) return snap;\n    snap = _;\n    return slider;\n  };\n\n  slider.scale = function(_) {\n    if (!arguments.length) return scale;\n    scale = _;\n    return slider;\n  };\n\n  d3.rebind(slider, dispatch, \"on\");\n\n  return slider;\n\n}\n}));\n"]}